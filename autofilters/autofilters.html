<!DOCTYPE HTML>
<html lang="en" class="light" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Working with Autofilters - Working with the rust_xlsxwriter library</title>


        <!-- Custom HTML head -->
        
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->

    </head>
    <body class="sidebar-visible no-js">
    <div id="body-container">
        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('light')
            html.classList.add(theme);
            var body = document.querySelector('body');
            body.classList.remove('no-js')
            body.classList.add('js');
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var body = document.querySelector('body');
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            body.classList.remove('sidebar-visible');
            body.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded affix "><a href="../index.html">rust_xlsxwriter</a></li><li class="chapter-item expanded affix "><a href="../introduction.html">Introduction</a></li><li class="chapter-item expanded "><a href="../getting_started.html"><strong aria-hidden="true">1.</strong> Getting started</a></li><li class="chapter-item expanded "><a href="../tutorial/intro.html"><strong aria-hidden="true">2.</strong> Tutorial</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../tutorial/tutorial1.html"><strong aria-hidden="true">2.1.</strong> Adding data to a worksheet</a></li><li class="chapter-item expanded "><a href="../tutorial/tutorial2.html"><strong aria-hidden="true">2.2.</strong> Adding some formatting</a></li><li class="chapter-item expanded "><a href="../tutorial/tutorial3.html"><strong aria-hidden="true">2.3.</strong> Adding dates and more formatting</a></li><li class="chapter-item expanded "><a href="../tutorial/tutorial4.html"><strong aria-hidden="true">2.4.</strong> Adding a chart</a></li><li class="chapter-item expanded "><a href="../tutorial/tutorial5.html"><strong aria-hidden="true">2.5.</strong> Making the code more programmatic</a></li></ol></li><li class="chapter-item expanded "><a href="../workbook/intro.html"><strong aria-hidden="true">3.</strong> The Workbook struct</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../workbook/saving.html"><strong aria-hidden="true">3.1.</strong> Creating and saving an xlsx file</a></li><li class="chapter-item expanded "><a href="../workbook/checksum.html"><strong aria-hidden="true">3.2.</strong> Checksum of a saved file</a></li></ol></li><li class="chapter-item expanded "><a href="../worksheet/intro.html"><strong aria-hidden="true">4.</strong> The Worksheet struct</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../worksheet/create.html"><strong aria-hidden="true">4.1.</strong> Creating worksheets</a></li><li class="chapter-item expanded "><a href="../worksheet/page_setup.html"><strong aria-hidden="true">4.2.</strong> Page Setup</a></li><li class="chapter-item expanded "><a href="../worksheet/headers.html"><strong aria-hidden="true">4.3.</strong> Adding Headers and Footers</a></li><li class="chapter-item expanded "><a href="../worksheet/autofit.html"><strong aria-hidden="true">4.4.</strong> Autofitting column widths</a></li><li class="chapter-item expanded "><a href="../worksheet/tabs.html"><strong aria-hidden="true">4.5.</strong> Working with worksheet tabs</a></li><li class="chapter-item expanded "><a href="../worksheet/protection.html"><strong aria-hidden="true">4.6.</strong> Worksheet protection</a></li></ol></li><li class="chapter-item expanded "><a href="../format/intro.html"><strong aria-hidden="true">5.</strong> The Format struct</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../format/creating.html"><strong aria-hidden="true">5.1.</strong> Creating and using a Format object</a></li><li class="chapter-item expanded "><a href="../format/defaults.html"><strong aria-hidden="true">5.2.</strong> Format defaults</a></li><li class="chapter-item expanded "><a href="../format/methods.html"><strong aria-hidden="true">5.3.</strong> Format methods</a></li><li class="chapter-item expanded "><a href="../format/categories.html"><strong aria-hidden="true">5.4.</strong> Number Format Categories</a></li><li class="chapter-item expanded "><a href="../format/locals.html"><strong aria-hidden="true">5.5.</strong> Number Formats in different Locals</a></li></ol></li><li class="chapter-item expanded "><a href="../colors/intro.html"><strong aria-hidden="true">6.</strong> Working with Colors</a></li><li class="chapter-item expanded "><a href="../formulas/intro.html"><strong aria-hidden="true">7.</strong> Working with Formulas</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../formulas/results.html"><strong aria-hidden="true">7.1.</strong> Formula Results</a></li><li class="chapter-item expanded "><a href="../formulas/syntax.html"><strong aria-hidden="true">7.2.</strong> Non US Excel functions and syntax</a></li><li class="chapter-item expanded "><a href="../formulas/dynamic_arrays.html"><strong aria-hidden="true">7.3.</strong> Dynamic Array support</a></li><li class="chapter-item expanded "><a href="../formulas/future_functions.html"><strong aria-hidden="true">7.4.</strong> Formulas added in Excel 2010 and later</a></li><li class="chapter-item expanded "><a href="../formulas/errors.html"><strong aria-hidden="true">7.5.</strong> Dealing with formula errors</a></li></ol></li><li class="chapter-item expanded "><a href="../autofilters/autofilters.html" class="active"><strong aria-hidden="true">8.</strong> Working with Autofilters</a></li><li class="chapter-item expanded "><a href="../examples/intro.html"><strong aria-hidden="true">9.</strong> Cookbook Examples</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../examples/hello_world.html"><strong aria-hidden="true">9.1.</strong> Hello World</a></li><li class="chapter-item expanded "><a href="../examples/demo.html"><strong aria-hidden="true">9.2.</strong> Feature demo</a></li><li class="chapter-item expanded "><a href="../examples/formatting.html"><strong aria-hidden="true">9.3.</strong> Cell formatting</a></li><li class="chapter-item expanded "><a href="../examples/merge_range.html"><strong aria-hidden="true">9.4.</strong> Merging cells</a></li><li class="chapter-item expanded "><a href="../examples/autofilter.html"><strong aria-hidden="true">9.5.</strong> Adding autofilters</a></li><li class="chapter-item expanded "><a href="../examples/autofit.html"><strong aria-hidden="true">9.6.</strong> Autofitting columns</a></li><li class="chapter-item expanded "><a href="../examples/tables.html"><strong aria-hidden="true">9.7.</strong> Adding worksheet tables</a></li><li class="chapter-item expanded "><a href="../examples/conditional_formats.html"><strong aria-hidden="true">9.8.</strong> Adding conditional formatting</a></li><li class="chapter-item expanded "><a href="../examples/data_validation.html"><strong aria-hidden="true">9.9.</strong> Using data validation</a></li><li class="chapter-item expanded "><a href="../examples/notes.html"><strong aria-hidden="true">9.10.</strong> Adding cell notes</a></li><li class="chapter-item expanded "><a href="../examples/generic_write.html"><strong aria-hidden="true">9.11.</strong> Extending generic write()</a></li><li class="chapter-item expanded "><a href="../examples/rich_strings.html"><strong aria-hidden="true">9.12.</strong> Rich strings</a></li><li class="chapter-item expanded "><a href="../examples/colors.html"><strong aria-hidden="true">9.13.</strong> Format colors</a></li><li class="chapter-item expanded "><a href="../examples/hyperlinks.html"><strong aria-hidden="true">9.14.</strong> Hyperlinks</a></li><li class="chapter-item expanded "><a href="../examples/simple_chart.html"><strong aria-hidden="true">9.15.</strong> Chart: Simple</a></li><li class="chapter-item expanded "><a href="../examples/chart_styles.html"><strong aria-hidden="true">9.16.</strong> Chart: Styles</a></li><li class="chapter-item expanded "><a href="../examples/area_chart.html"><strong aria-hidden="true">9.17.</strong> Chart: Area</a></li><li class="chapter-item expanded "><a href="../examples/bar_chart.html"><strong aria-hidden="true">9.18.</strong> Chart: Bar</a></li><li class="chapter-item expanded "><a href="../examples/column_chart.html"><strong aria-hidden="true">9.19.</strong> Chart: Column</a></li><li class="chapter-item expanded "><a href="../examples/line_chart.html"><strong aria-hidden="true">9.20.</strong> Chart: Line</a></li><li class="chapter-item expanded "><a href="../examples/scatter_chart.html"><strong aria-hidden="true">9.21.</strong> Chart: Scatter</a></li><li class="chapter-item expanded "><a href="../examples/radar_chart.html"><strong aria-hidden="true">9.22.</strong> Chart: Radar</a></li><li class="chapter-item expanded "><a href="../examples/pie_chart.html"><strong aria-hidden="true">9.23.</strong> Chart: Pie</a></li><li class="chapter-item expanded "><a href="../examples/stock_chart.html"><strong aria-hidden="true">9.24.</strong> Chart: Stock</a></li><li class="chapter-item expanded "><a href="../examples/doughnut_chart.html"><strong aria-hidden="true">9.25.</strong> Chart: Doughnut</a></li><li class="chapter-item expanded "><a href="../examples/chart_secondary_axis.html"><strong aria-hidden="true">9.26.</strong> Chart: Using a secondary axis</a></li><li class="chapter-item expanded "><a href="../examples/chart_combined.html"><strong aria-hidden="true">9.27.</strong> Chart: Create a combined chart</a></li><li class="chapter-item expanded "><a href="../examples/chart_pareto.html"><strong aria-hidden="true">9.28.</strong> Chart: Create a combined pareto chart</a></li><li class="chapter-item expanded "><a href="../examples/chart_pattern.html"><strong aria-hidden="true">9.29.</strong> Chart: Pattern Fill</a></li><li class="chapter-item expanded "><a href="../examples/chart_gradient.html"><strong aria-hidden="true">9.30.</strong> Chart: Gradient Fill</a></li><li class="chapter-item expanded "><a href="../examples/chart_data_table.html"><strong aria-hidden="true">9.31.</strong> Chart: Data table</a></li><li class="chapter-item expanded "><a href="../examples/chart_data_tools.html"><strong aria-hidden="true">9.32.</strong> Chart: Data tools</a></li><li class="chapter-item expanded "><a href="../examples/chart_gauge.html"><strong aria-hidden="true">9.33.</strong> Chart: Gauge Chart</a></li><li class="chapter-item expanded "><a href="../examples/macros.html"><strong aria-hidden="true">9.34.</strong> Macros: Adding macros to a workbook</a></li><li class="chapter-item expanded "><a href="../examples/sparklines1.html"><strong aria-hidden="true">9.35.</strong> Sparklines: Simple example</a></li><li class="chapter-item expanded "><a href="../examples/sparklines2.html"><strong aria-hidden="true">9.36.</strong> Sparklines: Example with optional properties</a></li><li class="chapter-item expanded "><a href="../examples/images.html"><strong aria-hidden="true">9.37.</strong> Inserting images</a></li><li class="chapter-item expanded "><a href="../examples/embedded_images.html"><strong aria-hidden="true">9.38.</strong> Embedding images in cells</a></li><li class="chapter-item expanded "><a href="../examples/insert_image_to_fit.html"><strong aria-hidden="true">9.39.</strong> Inserting images to fit</a></li><li class="chapter-item expanded "><a href="../examples/right_to_left.html"><strong aria-hidden="true">9.40.</strong> Right to left display</a></li><li class="chapter-item expanded "><a href="../examples/defined_names.html"><strong aria-hidden="true">9.41.</strong> Using defined names</a></li><li class="chapter-item expanded "><a href="../examples/dynamic_arrays.html"><strong aria-hidden="true">9.42.</strong> Dynamic array formulas</a></li><li class="chapter-item expanded "><a href="../examples/lambda.html"><strong aria-hidden="true">9.43.</strong> Excel LAMBDA() function</a></li><li class="chapter-item expanded "><a href="../examples/headers.html"><strong aria-hidden="true">9.44.</strong> Headers and Footers</a></li><li class="chapter-item expanded "><a href="../examples/doc_properties.html"><strong aria-hidden="true">9.45.</strong> Setting document properties</a></li><li class="chapter-item expanded "><a href="../examples/doc_sensitivity_label.html"><strong aria-hidden="true">9.46.</strong> Setting the Sensitivity Label</a></li><li class="chapter-item expanded "><a href="../examples/watermark.html"><strong aria-hidden="true">9.47.</strong> Adding a watermark</a></li><li class="chapter-item expanded "><a href="../examples/panes.html"><strong aria-hidden="true">9.48.</strong> Freeze Panes</a></li><li class="chapter-item expanded "><a href="../examples/protection.html"><strong aria-hidden="true">9.49.</strong> Worksheet protection</a></li></ol></li><li class="chapter-item expanded "><a href="../performance.html"><strong aria-hidden="true">10.</strong> Performance</a></li><li class="chapter-item expanded "><a href="../changelog.html"><strong aria-hidden="true">11.</strong> Release Notes</a></li><li class="chapter-item expanded "><a href="../license.html"><strong aria-hidden="true">12.</strong> License</a></li><li class="chapter-item expanded "><a href="../author.html"><strong aria-hidden="true">13.</strong> Author</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <!-- Track and set sidebar scroll position -->
        <script>
            var sidebarScrollbox = document.querySelector('#sidebar .sidebar-scrollbox');
            sidebarScrollbox.addEventListener('click', function(e) {
                if (e.target.tagName === 'A') {
                    sessionStorage.setItem('sidebar-scroll', sidebarScrollbox.scrollTop);
                }
            }, { passive: true });
            var sidebarScrollTop = sessionStorage.getItem('sidebar-scroll');
            sessionStorage.removeItem('sidebar-scroll');
            if (sidebarScrollTop) {
                // preserve sidebar scroll position when navigating via links within sidebar
                sidebarScrollbox.scrollTop = sidebarScrollTop;
            } else {
                // scroll sidebar to current active section when navigating via "next/previous chapter" buttons
                var activeSection = document.querySelector('#sidebar .active');
                if (activeSection) {
                    activeSection.scrollIntoView({ block: 'center' });
                }
            }
        </script>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Working with the rust_xlsxwriter library</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="working-with-autofilters"><a class="header" href="#working-with-autofilters">Working with Autofilters</a></h1>
<p>An autofilter is a way of adding drop down lists to the headers of a 2D range of
worksheet data. This allows users to filter the data based on simple criteria so
that some data is shown and some is hidden.</p>
<p><img src="../../images/app_autofilter1.png" alt="Image of output from app_autofilter.rs" /></p>
<p>In rust_xlsxwriter this is set using the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/worksheet/struct.Worksheet.html#method.autofilter"><code>Worksheet::autofilter()</code></a> method:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span>    worksheet.autofilter(0, 0, 50, 3)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<h2 id="filter-types"><a class="header" href="#filter-types">Filter types</a></h2>
<p>Excel supports two main types of filter conditions. The first, and most common,
is a list filter where the user selects the items to filter from a list of all
the values in the the column range:</p>
<p><img src="../../images/autofilter_list.png" alt="Excel autofilter dialog" /></p>
<p>The other main type of filter is a custom filter where the user can specify 1 or
2 conditions like "&gt;= 4000" and "&lt;= 6000":</p>
<p><img src="../../images/autofilter_custom.png" alt="Excel autofilter dialog" /></p>
<p>In Excel these are mutually exclusive and you will need to choose one or the
other depending on your needs.</p>
<p>In rust_xlsxwriter you can set these filters using the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html"><code>FilterCondition</code></a> struct and
the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html#method.add_list_filter"><code>FilterCondition.add_list_filter()</code></a> and
<a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html#method.add_custom_filter"><code>FilterCondition.add_custom_filter()</code></a> methods. Some examples of these are shown in the next section.</p>
<h2 id="filter-examples"><a class="header" href="#filter-examples">Filter examples</a></h2>
<p>Using the autofilter data and range shown above we will look at some examples of
setting filters to highlight certain rows.</p>
<p>The first example is a list filter to show only rows that are in the "East"
region in the first column:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span>    let filter_condition = FilterCondition::new().add_list_filter("East");
    worksheet.filter_column(0, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Example output. Note that the filtered column shows a funnel symbol as part of
the dropdown arrow and the non matching rows are filtered out:</p>
<p><img src="../../images/app_autofilter2.png" alt="Image of output from app_autofilter.rs" /></p>
<p>Multiple list conditions can be set by repeating <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html#method.add_list_filter"><code>FilterCondition.add_list_filter()</code></a>:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span>    let filter_condition = FilterCondition::new()
        .add_list_filter("East")
        .add_list_filter("West")
        .add_list_filter("South");
    worksheet.filter_column(0, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Example output:</p>
<p><img src="../../images/app_autofilter3.png" alt="Image of output from app_autofilter.rs" /></p>
<p>If the data contains blanks you can filter those cells as part of a list filter
or on their own using <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html#method.add_list_blanks_filter"><code>FilterCondition.add_list_blanks_filter()</code></a>:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span>    let filter_condition = FilterCondition::new().add_list_blanks_filter();
    worksheet.filter_column(0, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Example output:</p>
<p><img src="../../images/app_autofilter4.png" alt="Image of output from app_autofilter.rs" /></p>
<p>Filters can be added to more than one autofilter column to show specific data
only:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span>    let filter_condition1 = FilterCondition::new().add_list_filter("East");
    worksheet.filter_column(0, &amp;filter_condition1)?;

    let filter_condition2 = FilterCondition::new().add_list_filter("July");
    worksheet.filter_column(3, &amp;filter_condition2)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Example output, note the filters on columns A and D:</p>
<p><img src="../../images/app_autofilter5.png" alt="Image of output from app_autofilter.rs" /></p>
<p>For finer grained control of the filtered data Excel allows 1 or 2 "custom"
filters for conditions like <code>&gt;=</code> or <code>begins with</code> (for strings):</p>
<p><img src="../../images/autofilter_custom_menu.png" alt="Excel autofilter dialog" /></p>
<p>In rust_xlsxwriter you can set custom filters using the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html"><code>FilterCondition</code></a>
struct and the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html#method.add_custom_filter"><code>FilterCondition.add_custom_filter()</code></a> method. The
criteria/operators are set using the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCriteria.html"><code>FilterCriteria</code></a> struct:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span>    let filter_condition =
        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
    worksheet.filter_column(2, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Example output:</p>
<p><img src="../../images/app_autofilter6.png" alt="Image of output from app_autofilter.rs" /></p>
<p>Using both custom filter conditions you can create conditions like "between":</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span>    let filter_condition = FilterCondition::new()
        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
    worksheet.filter_column(2, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Example output:</p>
<p><img src="../../images/app_autofilter7.png" alt="Image of output from app_autofilter.rs" /></p>
<p>Note, Excel defaults to using an "And" operator for 2 custom filters but you can
set an "Or" operator using the <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/struct.FilterCondition.html#method.add_custom_boolean_or"><code>FilterCondition.add_custom_boolean_or()</code></a>
method.</p>
<h2 id="filtering-non-blanks"><a class="header" href="#filtering-non-blanks">Filtering Non-blanks</a></h2>
<p>Excel supports, and uses, two different way to filter on non-blanks. The first
is to filter all the unique non-blank strings/numbers in the column.</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span>    let filter_condition = FilterCondition::new()
        .add_list_filter("East")
        .add_list_filter("West")
        .add_list_filter("North")
        .add_list_filter("South");
    worksheet.filter_column(0, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>However, if this is programmatically difficult to set up  you can add a simpler
custom filter to get the same result:</p>
<pre><code class="language-rust"><span class="boring">// SPDX-License-Identifier: MIT OR Apache-2.0
</span><span class="boring">//
</span><span class="boring">// Copyright 2022-2024, John McNamara, jmcnamara@cpan.org
</span><span class="boring">
</span><span class="boring">//! An example of how to create autofilters with the rust_xlsxwriter library.
</span><span class="boring">//!
</span><span class="boring">//! An autofilter is a way of adding drop down lists to the headers of a 2D
</span><span class="boring">//! range of worksheet data. This allows users to filter the data based on
</span><span class="boring">//! simple criteria so that some data is shown and some is hidden.
</span><span class="boring">//!
</span><span class="boring">
</span><span class="boring">use rust_xlsxwriter::{FilterCondition, FilterCriteria, Format, Workbook, Worksheet, XlsxError};
</span><span class="boring">
</span><span class="boring">fn main() -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // Create a new Excel file object.
</span><span class="boring">    let mut workbook = Workbook::new();
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 1. Add an autofilter to a data range.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area, including the header/filter row.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 2. Add an autofilter with a list filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East" in the first
</span><span class="boring">    // column.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 3. Add an autofilter with a list filter condition on multiple items.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching "East", "West" or
</span><span class="boring">    // "South" in the first column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 4. Add an autofilter with a list filter condition to match blank cells.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition to only show cells matching blanks.
</span><span class="boring">    let filter_condition = FilterCondition::new().add_list_blanks_filter();
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 5. Add an autofilter with list filters in multiple columns.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a filter condition for 2 separate columns.
</span><span class="boring">    let filter_condition1 = FilterCondition::new().add_list_filter("East");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition1)?;
</span><span class="boring">
</span><span class="boring">    let filter_condition2 = FilterCondition::new().add_list_filter("July");
</span><span class="boring">    worksheet.filter_column(3, &amp;filter_condition2)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 6. Add an autofilter with custom filter condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area for numbers greater than 8000.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter.
</span><span class="boring">    let filter_condition =
</span><span class="boring">        FilterCondition::new().add_custom_filter(FilterCriteria::GreaterThan, 8000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 7. Add an autofilter with 2 custom filters to create a "between" condition.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, false)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Set two custom number filters in a "between" configuration.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_custom_filter(FilterCriteria::GreaterThanOrEqualTo, 4000)
</span><span class="boring">        .add_custom_filter(FilterCriteria::LessThanOrEqualTo, 6000);
</span><span class="boring">    worksheet.filter_column(2, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">    // 8. Add an autofilter for non blanks.
</span><span class="boring">    // -----------------------------------------------------------------------
</span><span class="boring">
</span><span class="boring">    // Add a worksheet  with some sample data to filter.
</span><span class="boring">    let worksheet = workbook.add_worksheet();
</span><span class="boring">    populate_autofilter_data(worksheet, true)?;
</span><span class="boring">
</span><span class="boring">    // Set the autofilter area.
</span><span class="boring">    worksheet.autofilter(0, 0, 50, 3)?;
</span><span class="boring">
</span><span class="boring">    // Filter non-blanks by filtering on all the unique non-blank
</span><span class="boring">    // strings/numbers in the column.
</span><span class="boring">    let filter_condition = FilterCondition::new()
</span><span class="boring">        .add_list_filter("East")
</span><span class="boring">        .add_list_filter("West")
</span><span class="boring">        .add_list_filter("North")
</span><span class="boring">        .add_list_filter("South");
</span><span class="boring">    worksheet.filter_column(0, &amp;filter_condition)?;
</span><span class="boring">
</span><span class="boring">    // Or you can add a simpler custom filter to get the same result.
</span><span class="boring">
</span><span class="boring">    // Set a custom number filter of `!= " "` to filter non blanks.
</span>    let filter_condition =
        FilterCondition::new().add_custom_filter(FilterCriteria::NotEqualTo, " ");
    worksheet.filter_column(0, &amp;filter_condition)?;
<span class="boring">
</span><span class="boring">    // Save the file to disk.
</span><span class="boring">    workbook.save("autofilter.xlsx")?;
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}
</span><span class="boring">
</span><span class="boring">// Generate worksheet data to filter on.
</span><span class="boring">pub fn populate_autofilter_data(
</span><span class="boring">    worksheet: &amp;mut Worksheet,
</span><span class="boring">    add_blanks: bool,
</span><span class="boring">) -&gt; Result&lt;(), XlsxError&gt; {
</span><span class="boring">    // The sample data to add to the worksheet.
</span><span class="boring">    let mut data = vec![
</span><span class="boring">        ("East", "Apple", 9000, "July"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("South", "Orange", 9000, "September"),
</span><span class="boring">        ("North", "Apple", 2000, "November"),
</span><span class="boring">        ("West", "Apple", 9000, "November"),
</span><span class="boring">        ("South", "Pear", 7000, "October"),
</span><span class="boring">        ("North", "Pear", 9000, "August"),
</span><span class="boring">        ("West", "Orange", 1000, "December"),
</span><span class="boring">        ("West", "Grape", 1000, "November"),
</span><span class="boring">        ("South", "Pear", 10000, "April"),
</span><span class="boring">        ("West", "Grape", 6000, "January"),
</span><span class="boring">        ("South", "Orange", 3000, "May"),
</span><span class="boring">        ("North", "Apple", 3000, "December"),
</span><span class="boring">        ("South", "Apple", 7000, "February"),
</span><span class="boring">        ("West", "Grape", 1000, "December"),
</span><span class="boring">        ("East", "Grape", 8000, "February"),
</span><span class="boring">        ("South", "Grape", 10000, "June"),
</span><span class="boring">        ("West", "Pear", 7000, "December"),
</span><span class="boring">        ("South", "Apple", 2000, "October"),
</span><span class="boring">        ("East", "Grape", 7000, "December"),
</span><span class="boring">        ("North", "Grape", 6000, "July"),
</span><span class="boring">        ("East", "Pear", 8000, "February"),
</span><span class="boring">        ("North", "Apple", 7000, "August"),
</span><span class="boring">        ("North", "Orange", 7000, "July"),
</span><span class="boring">        ("North", "Apple", 6000, "June"),
</span><span class="boring">        ("South", "Grape", 8000, "September"),
</span><span class="boring">        ("West", "Apple", 3000, "October"),
</span><span class="boring">        ("South", "Orange", 10000, "November"),
</span><span class="boring">        ("West", "Grape", 4000, "December"),
</span><span class="boring">        ("North", "Orange", 5000, "August"),
</span><span class="boring">        ("East", "Orange", 1000, "November"),
</span><span class="boring">        ("East", "Orange", 4000, "October"),
</span><span class="boring">        ("North", "Grape", 5000, "August"),
</span><span class="boring">        ("East", "Apple", 1000, "July"),
</span><span class="boring">        ("South", "Apple", 10000, "March"),
</span><span class="boring">        ("East", "Grape", 7000, "October"),
</span><span class="boring">        ("West", "Grape", 1000, "September"),
</span><span class="boring">        ("East", "Grape", 10000, "October"),
</span><span class="boring">        ("South", "Orange", 8000, "March"),
</span><span class="boring">        ("North", "Apple", 4000, "July"),
</span><span class="boring">        ("South", "Orange", 5000, "July"),
</span><span class="boring">        ("West", "Apple", 4000, "June"),
</span><span class="boring">        ("East", "Apple", 5000, "April"),
</span><span class="boring">        ("North", "Pear", 3000, "August"),
</span><span class="boring">        ("East", "Grape", 9000, "November"),
</span><span class="boring">        ("North", "Orange", 8000, "October"),
</span><span class="boring">        ("East", "Apple", 10000, "June"),
</span><span class="boring">        ("South", "Pear", 1000, "December"),
</span><span class="boring">        ("North", "Grape", 10000, "July"),
</span><span class="boring">        ("East", "Grape", 6000, "February"),
</span><span class="boring">    ];
</span><span class="boring">
</span><span class="boring">    // Introduce blanks cells for some of the examples.
</span><span class="boring">    if add_blanks {
</span><span class="boring">        data[5].0 = "";
</span><span class="boring">        data[18].0 = "";
</span><span class="boring">        data[30].0 = "";
</span><span class="boring">        data[40].0 = "";
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    // Widen the columns for clarity.
</span><span class="boring">    worksheet.set_column_width(0, 12)?;
</span><span class="boring">    worksheet.set_column_width(1, 12)?;
</span><span class="boring">    worksheet.set_column_width(2, 12)?;
</span><span class="boring">    worksheet.set_column_width(3, 12)?;
</span><span class="boring">
</span><span class="boring">    // Write the header titles.
</span><span class="boring">    let header_format = Format::new().set_bold();
</span><span class="boring">    worksheet.write_string_with_format(0, 0, "Region", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 1, "Item", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 2, "Volume", &amp;header_format)?;
</span><span class="boring">    worksheet.write_string_with_format(0, 3, "Month", &amp;header_format)?;
</span><span class="boring">
</span><span class="boring">    // Write the other worksheet data.
</span><span class="boring">    for (row, data) in data.iter().enumerate() {
</span><span class="boring">        let row = 1 + row as u32;
</span><span class="boring">        worksheet.write_string(row, 0, data.0)?;
</span><span class="boring">        worksheet.write_string(row, 1, data.1)?;
</span><span class="boring">        worksheet.write_number(row, 2, data.2)?;
</span><span class="boring">        worksheet.write_string(row, 3, data.3)?;
</span><span class="boring">    }
</span><span class="boring">
</span><span class="boring">    Ok(())
</span><span class="boring">}</span></code></pre>
<p>Excel uses both these methods depending on context. Example output from either
method:</p>
<p><img src="../../images/app_autofilter8.png" alt="Image of output from app_autofilter.rs" /></p>
<h2 id="auto-hiding-filtered-rows"><a class="header" href="#auto-hiding-filtered-rows">Auto-hiding filtered rows</a></h2>
<p>When you add a filter condition to an autofilter in Excel it automatically hides
all the rows that don't match the filter. This is something that happens at
runtime and isn't part of the file format.</p>
<p>In order to simulate this behavior the rust_xlsxwriter library iterates through
the worksheet data in the autofilter range and hides any rows that don't match.
This is an additional feature that isn't available in the other language ports
of "xlsxwriter". In those versions the programmer has to iterate through the
input data and hide the rows manually.</p>
<p>In general the auto-hiding in rust_xlsxwriter works as expected, as can be seen
in the examples above. However, there are some limitations such as:</p>
<ul>
<li>Only String, Number and Blank cells are currently handled.</li>
<li>The return values from formulas are generally unknown and unhandled.</li>
<li>Excel supports some simple regex matching of strings with <code>?</code> and <code>*</code> when
used with <code>FilterCriteria::Contains</code> and <code>DoesNotContain</code>. These are not
currently supported.</li>
</ul>
<p>If you have some filter criteria that isn't handled correctly you can add to the
filtered rows by using <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/worksheet/struct.Worksheet.html#method.set_row_hidden"><code>Worksheet::set_row_hidden()</code></a>.</p>
<p>If the auto-hiding is incorrect you can also turn it off and handle it manually
using <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/worksheet/struct.Worksheet.html#method.filter_automatic_off"><code>Worksheet::filter_automatic_off()</code></a> or <a href="https://docs.rs/rust_xlsxwriter/latest/rust_xlsxwriter/worksheet/struct.Worksheet.html#method.set_row_unhidden"><code>Worksheet::set_row_unhidden()</code></a>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../formulas/errors.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../examples/intro.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../formulas/errors.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../examples/intro.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
